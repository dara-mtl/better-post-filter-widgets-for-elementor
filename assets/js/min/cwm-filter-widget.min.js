!function(e){e(window).on("elementor/frontend/init",function(){var a=elementorModules.frontend.handlers.Base.extend({bindEvents:function(){this.getAjaxFilter()},getAjaxFilter:function(){var a=!1;e(".cwm-select2")[0]&&e(".cwm-select2 select").prop("multiple",!1).select2(),e(".cwm-multi-select2")[0]&&(e(".cwm-multi-select2 select").prop("multiple",!0).select2({placeholder:"Choose an option"}),e(".cwm-multi-select2 select").val(null).trigger("change"));var t=this.$element.find(".elementor-widget-container"),n=window.elementorFrontendConfig.post.id,o=this.$element.data("settings"),i=o.target_selector;if(i){var r=o.group_logic,l=o.dynamic_filtering,s=o.scroll_to_top,d=e(i),c=d.data("id"),m=d.html(),f=d.find(".loader"),p=d.find(".pagination"),u=p.data("page"),h=p.data("max-page")-1,v=d.data("settings"),g=v.pagination?v.pagination:v.pagination_type;if(o&&o.display_animation)var y=o.display_animation;(0===n||void 0===n)&&(0===(n=e("header").next("div").data("elementor-id"))||void 0===n)&&(n=e("main div:first").data("elementor-id"));var x=t.find(".submit-form").length>0;t.on("change keypress","form.form-tax",function(e){x||"keypress"===e.type&&13!=e.which||C()}),t.on("submit","form",function(){return C(),!1}),e(document).on("change","form.form-order-by",function(){x||C()}),e(document).on("submit",".search-container form",function(){return C(),!1}),e(document).on("click",i+" .pagination-filter a",function(a){a.preventDefault();var t,n,o=e(this).attr("href");C(t=(n=o.includes("?page=")?o.match(/\?page=(\d+)/):o.includes("?paged=")?o.match(/\?paged=(\d+)/):o.match(/\/(\d+)\//))?n[1]:null)}),e(document).on("click",i+" .load-more-filter",function(a){a.preventDefault();var t,n,o=d.find(".e-load-more-anchor").data("next-page");if(o)C(t=(n=o.includes("?page=")?o.match(/\?page=(\d+)/):o.includes("?paged=")?o.match(/\?paged=(\d+)/):o.match(/\/(\d+)\//))?n[1]:null);else{u+=1,e(document).find(i+" .pagination-filter a.next").click();var r=d.find(".load-more");r.text("Loading..."),r.prop("disabled",!0)}}),"infinite"==g&&e(window).on("scroll",function(){var t=e(document).height(),n=e(window).height()+e(window).scrollTop(),o=e(document).find(i+" .pagination-filter a.next");if(t-n<=300&&!a&&u<=h){var r=d.find(".load-more");r.text("Loading..."),r.prop("disabled",!0),o.click(),u+=1,a=!0}}),t.on("click","li.more",function(){var a=e(this).closest("ul.taxonomy-filter");a.hasClass("yes")?a.removeClass("yes"):a.addClass("yes"),e(this).text(function(e,a){return"More..."===a?"Less...":"More..."})}),e("form.form-tax input").on("keypress",function(e){13===e.which&&e.preventDefault()}),t.on("click",".reset-form",function(){C()}),w()}function w(){var a=d.find(".post-container").data("total-post");void 0===a&&(a=0),a>"1"?e(".filter-post-count").html(a+" results found"):e(".filter-post-count").html(a+" result found")}function C(t){var o=d.find(".post-container"),i=e("form.form-tax").data("post-type"),p="",h="";order_by_meta="";var v=e(".search-container form").find('input[name="s"]').val();e(".form-order-by select option:selected").each(function(){var a=e(this);p=a.data("order"),order_by_meta=a.data("meta"),h=a.val()}),"yes"!==y||d.hasClass("elementor-widget-post-widget")||d.addClass("filter-load"),d.removeClass("e-load-more-pagination-end"),o.addClass("load"),(o.hasClass("shortcode")||o.hasClass("template"))&&f.fadeIn();var x=[],C=[],$=[],_=[];function b(e){return e.reduce(function(e,a){var t=e.reduce(function(e,t,n){return t.taxonomy===a.taxonomy?n:e},-1);if(t>=0)e[t].terms=e[t].terms.concat(a.terms);else{var n={taxonomy:a.taxonomy,terms:[a.terms],logic:a.logic};e=e.concat([n])}return e},[])}e(".cwm-taxonomy-wrapper input:checked, .cwm-custom-field-wrapper input:checked").each(function(){var a=e(this);(a.closest(".cwm-taxonomy-wrapper").length?x:C).push({taxonomy:a.data("taxonomy"),terms:a.val(),logic:a.closest("div").data("logic")})}),e(".cwm-custom-field-wrapper input.input-text").each(function(){var a=e(this);a.val()&&$.push({taxonomy:a.data("taxonomy"),terms:a.val(),logic:a.closest("div").data("logic")})}),e(".cwm-taxonomy-wrapper select option:selected, .cwm-custom-field-wrapper select option:selected").each(function(){var a=e(this);a.val()&&(a.closest(".cwm-taxonomy-wrapper").length?x:C).push({taxonomy:a.data("taxonomy"),terms:a.val(),logic:a.closest("div").data("logic")})}),e(".cwm-numeric-wrapper input").each(function(){var a=e(this),t=a.data("base-value");if(""===a.val()||a.val()!=t){""===a.val()&&a.val(t);var n=a.attr("class");e(".cwm-numeric-wrapper").find("."+n).each(function(){var a=e(this);_.push({taxonomy:a.data("taxonomy"),terms:a.val(),logic:a.closest("div").data("logic")})})}});var k=b(x),I=b(C),j=b($),T=b(_);e.ajax({type:"POST",url:ajax_var.url,async:!0,data:{action:"post_filter_results",widget_id:c,page_id:n,group_logic:r,search_query:v,taxonomy_output:k,dynamic_filtering:l,custom_field_output:I,custom_field_like_output:j,numeric_output:T,post_type:i,order:p,order_by:h,order_by_meta:order_by_meta,paged:t,base:window.location.href,archive_type:e('[name="archive_type"]').val(),archive_post_type:e('[name="archive_post_type"]').val(),archive_taxonomy:e('[name="archive_taxonomy"]').val(),archive_id:e('[name="archive_id"]').val(),nonce:ajax_var.nonce},success:function(a){var t=JSON.parse(a),n=t.html,o=t.base;if("0"===a)d.html(m).fadeIn().removeClass("load"),d.removeClass("filter-load"),d.removeClass("loaded"),w(),elementorFrontend.elementsHandler.runReadyTrigger(d);else{if("infinite"==g||"load_more"==g||"load_more_on_click"==g||"load_more_infinite_scroll"==g||"cwm_infinite"==g){if(d.hasClass("loaded")){var i=d.find(".elementor-grid").children();d.html(n).fadeIn(),d.find(".elementor-grid").prepend(i).fadeIn().removeClass("load")}else d.html(n).fadeIn().removeClass("load")}else d.html(n).fadeIn().removeClass("load");if(f.fadeOut(),d.removeClass("filter-load"),e(n).text().trim()){var r=d.find('nav[aria-label="Pagination"]');r.addClass("pagination-filter"),r.find("a.page-numbers").each(function(){var a=e(this).attr("href");"/"===o.charAt(o.length-1)&&(o=o.slice(0,-1));var t=a.replace(/.*wp-admin\/admin-ajax\.php/,o);e(this).attr("href",t)});var l=d.find(".e-load-more-anchor"),s=d.find(".load-more"),c=d.find(".elementor-button-link.elementor-button");s.addClass("load-more-filter"),c.addClass("load-more-filter"),d.addClass("loaded");var p=l.data("next-page");if(void 0!==p){"/"===o.charAt(o.length-1)&&(o=o.slice(0,-1));var u=p.replace(/.*wp-admin\/admin-ajax\.php/,o);l.attr("data-next-page",u)}var h=d.data("settings");h.pagination_type="cwm_infinite";var v=JSON.stringify(h);d.attr("data-settings",v),w(),elementorFrontend.elementsHandler.runReadyTrigger(d)}else d.addClass("no-posts-found"),d.html("No posts found.").removeClass("load")}},complete:function(){var e=d.find(".load-more"),t=d.find(".pagination").data("max-page")-1;"yes"==s&&window.scrollTo({top:d.offset().top-150,behavior:"smooth"}),u>t&&e.hide(),a=!1}})}}});elementorFrontend.elementsHandler.attachHandler("filter-widget",a)})}(jQuery);