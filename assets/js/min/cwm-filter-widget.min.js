!function(e){"use strict";e(window).on("elementor/frontend/init",function(){let t=elementorModules.frontend.handlers.Base.extend({bindEvents(){this.getAjaxFilter()},getAjaxFilter(){let t=!1;if(e(".cwm-select2")[0]){var a=e(".cwm-select2");e(".cwm-select2 select").prop("multiple",!1).select2({dropdownParent:a}),e(".cwm-select2").css({visibility:"visible",opacity:"1",transition:"opacity 0.3s ease-in-out"})}if(e(".cwm-multi-select2")[0]){var a=e(".cwm-multi-select2");function i(){var t=e(".cwm-multi-select2 .select2-selection__rendered");t.find(".select2-selection__e-plus-button").remove(),0===e(".cwm-multi-select2 select").val().length&&t.prepend('<span class="select2-selection__choice select2-selection__e-plus-button">+</span>')}e(".cwm-multi-select2 select").prop("multiple",!0).select2({dropdownParent:a}),e(".cwm-multi-select2 select").val(null).trigger("change"),e(".cwm-multi-select2").css({visibility:"visible",opacity:"1",transition:"opacity 0.3s ease-in-out"}),i(),e(".cwm-multi-select2 select").on("change",i)}let n=this.$element.find(".elementor-widget-container"),o=window.elementorFrontendConfig.post.id,l=this.$element.data("settings");if(!l)return;let r=l.target_selector;if(!r||!r.length)return;let s=l.group_logic,c=l.dynamic_filtering,d=l.scroll_to_top,m=e(r),f=m.data("id"),p=m.html(),u=m.find(".loader"),h=m.find(".pagination");h.data("max-page");let v="";var g=g||{};let y=m.data("settings");if(y&&(y.pagination||y.pagination_type)){v=y.pagination||y.pagination_type;var w,x=(y.scroll_threshold&&y.scroll_threshold.size?y.scroll_threshold.size:0)+(y.scroll_threshold&&y.scroll_threshold.unit?y.scroll_threshold.unit:"px")}else var x="0px";let $=l&&l.display_animation,C=1;function b(e,t){let a;return function(){let i=this,n=arguments;clearTimeout(a),a=setTimeout(()=>{e.apply(i,n)},t)}}(0===o||void 0===o)&&(0===(o=e("header").next("div").data("elementor-id"))||void 0===o)&&(o=e("main div:first").data("elementor-id"));let _=n.find(".submit-form").length>0,k=!1,j;function z(e){var t;return(t=e.includes("?page=")?e.match(/\?page=(\d+)/):e.includes("?paged=")?e.match(/\?paged=(\d+)/):e.match(/\/(\d+)(\/|$)/)?e.match(/\/(\d+)(\/|$)/):e.match(/[?&](\w+)=\d+/))||(t=e.match(/(\d+)(\/|$)/)),t?t[1]:null}function I(){let e=window.location.origin+window.location.pathname;history.replaceState(null,"",e)}function A(){let t=m.find(".post-container").data("total-post");void 0===t&&(t=0),(t=Number(t))>"1"?e(".filter-post-count").html(t+" results found"):e(".filter-post-count").html(t+" result found")}function E(a){var i=m.find(".post-container"),n=e("form.form-tax").data("post-type"),l="",h="",y="",w=e(".search-container form").find('input[name="s"]').val();e(".form-order-by select option:selected").each(function(){var t=e(this);l=t.data("order"),y=t.data("meta"),h=t.val()}),"yes"!==$||m.hasClass("elementor-widget-post-widget")||m.addClass("filter-load"),m.removeClass("e-load-more-pagination-end"),i.addClass("load"),(i.hasClass("shortcode")||i.hasClass("template"))&&u.fadeIn();var C=[],_=[],k=[],j=[];function z(e){return e.reduce(function(e,t){var a=e.reduce(function(e,a,i){return a.taxonomy===t.taxonomy?i:e},-1);if(a>=0)e[a].terms=e[a].terms.concat(t.terms);else{var i={taxonomy:t.taxonomy,terms:[t.terms],logic:t.logic};e=e.concat([i])}return e},[])}e(".cwm-taxonomy-wrapper input:checked, .cwm-custom-field-wrapper input:checked").each(function(){var t=e(this);(t.closest(".cwm-taxonomy-wrapper").length?C:_).push({taxonomy:t.data("taxonomy"),terms:t.val(),logic:t.closest("div").data("logic")})}),e(".cwm-custom-field-wrapper input.input-text").each(function(){var t=e(this);t.val()&&k.push({taxonomy:t.data("taxonomy"),terms:t.val(),logic:t.closest("div").data("logic")})}),e(".cwm-taxonomy-wrapper select option:selected, .cwm-custom-field-wrapper select option:selected").each(function(){var t=e(this);t.val()&&(t.closest(".cwm-taxonomy-wrapper").length?C:_).push({taxonomy:t.data("taxonomy"),terms:t.val(),logic:t.closest("div").data("logic")})}),e(".cwm-numeric-wrapper input").each(function(){var t=e(this),a=t.data("base-value");if(""===t.val()||t.val()!=a){""===t.val()&&t.val(a);var i=t.attr("class").split(" ")[0];e(".cwm-numeric-wrapper").find("input").each(function(){var t=e(this);t.hasClass(i)&&j.push({taxonomy:t.data("taxonomy"),terms:t.val(),logic:t.closest("div").data("logic")})})}});var I=z(C),F=z(_),M=z(k),P=z(j);e.ajax({type:"POST",url:ajax_var.url,async:!0,data:{action:"post_filter_results",widget_id:f,page_id:o,group_logic:s,search_query:w,taxonomy_output:I,dynamic_filtering:c,custom_field_output:F,custom_field_like_output:M,numeric_output:P,post_type:n,order:l,order_by:h,order_by_meta:y,paged:a,archive_type:e('[name="archive_type"]').val(),archive_post_type:e('[name="archive_post_type"]').val(),archive_taxonomy:e('[name="archive_taxonomy"]').val(),archive_id:e('[name="archive_id"]').val(),nonce:ajax_var.nonce},success:function(t){var a=JSON.parse(t).html,i=window.location.href;if("0"===t){m.off(),m.html(p).fadeIn().removeClass("load"),m.removeClass("filter-active").removeClass("filter-load");var n=m.data("settings");"cwm_infinite"===n.pagination_type&&(n.pagination_type="load_more_infinite_scroll",m.data("settings",n)),"cwm_ajax"===n.pagination_load_type&&(n.pagination_load_type="ajax",m.data("settings",n)),A()}else{if("infinite"==v||"load_more"==v||"load_more_on_click"==v||"load_more_infinite_scroll"==v||"cwm_infinite"==v){if(m.hasClass("filter-active")){var o=m.find(".elementor-grid").children();m.html(a).fadeIn(),m.find(".elementor-grid").prepend(o).fadeIn().removeClass("load")}else m.html(a).fadeIn().removeClass("load")}else m.html(a).fadeIn().removeClass("load");if(u.fadeOut(),m.removeClass("filter-load"),e(a).text().trim()){var l=m.find('nav[aria-label="Pagination"]');l.addClass("pagination-filter"),l.find("a.page-numbers").each(function(){var t=e(this).attr("href");"/"===i.charAt(i.length-1)&&(i=i.slice(0,-1));var a=t.replace(/.*wp-admin\/admin-ajax\.php/,i);e(this).attr("href",a)});var s=m.find(".e-load-more-anchor"),c=s.data("next-page"),d=m.find(".load-more"),f=m.find(".elementor-button-link.elementor-button");if(d.addClass("load-more-filter"),f.addClass("load-more-filter"),m.addClass("filter-active"),void 0!==c){"/"===i.charAt(i.length-1)&&(i=i.slice(0,-1));var h=c.replace(/.*wp-admin\/admin-ajax\.php/,i);s.attr("data-next-page",h)}var n=m.data("settings");"load_more_infinite_scroll"===n.pagination_type&&(n.pagination_type="cwm_infinite",m.data("settings",n)),"ajax"===n.pagination_load_type&&(n.pagination_load_type="cwm_ajax",m.data("settings",n)),A()}else{var g=e('.no-post-message[data-target-post-widget="'+r+'"]').text();g.length&&m.html('<div class="no-post">'+g+"</div>")}}},complete:function(){var a,i=m.find(".load-more-filter"),n=m.data("settings").pagination||m.data("settings").pagination_type,o=m.find(".e-load-more-anchor");if(o.length){var l=o.data("page");a=o.data("max-page")-1}else var l=m.find(".pagination").data("page"),a=m.find(".pagination").data("max-page")-1;"yes"==d&&window.scrollTo({top:m.offset().top-150,behavior:"smooth"}),l>a&&i.hide(),t=!1,m.hasClass("filter-active")&&"infinite"==n&&b(function(a){(function a(i,n){var o=n.find(".e-load-more-anchor"),l=e(document).find(r+" .pagination-filter a.next");if(!l.length){g[i]&&(g[i].disconnect(),g[i]=null);return}l.length&&o.length&&(g[i]||(g[i]=new IntersectionObserver(function(a){a.forEach(function(a){if(a.isIntersecting){var i=e(document).find(r+" .pagination-filter a.next");!t&&i.length&&n.hasClass("filter-active")&&(t=!0,i.click())}})},{root:null,rootMargin:x,threshold:0})),g[i].observe(o.get(0)))})(f,m)},800)(),m.hasClass("filter-active")&&"cwm_infinite"==n&&b(function(e){(function e(a,i){var n=i.find(".e-load-more-anchor"),o=n.data("page"),l=n.data("max-page");if(o===l){g[a]&&(g[a].disconnect(),g[a]=null);return}n.length&&o<l&&(g[a]||(g[a]=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting&&!t&&i.hasClass("filter-active")&&(t=!0,E(++o))})},{root:null,rootMargin:x,threshold:0})),g[a].observe(n.get(0)))})(f,m)},800)(),elementorFrontend.elementsHandler.runReadyTrigger(e(r)),elementorFrontend.config.experimentalFeatures.e_lazyload&&document.dispatchEvent(new Event("elementor/lazyload/observe")),m.removeClass("filter-initialized")},error:function(e,t,a){console.log("AJAX error: ",a)}})}n.on("mousedown keydown touchstart","form.form-tax",function(){k=!0,clearTimeout(j)}),n.on("mouseup keyup touchend","form.form-tax",function(){j=setTimeout(()=>{k=!1},500)}),n.on("change keypress","form.form-tax",b(function(e){_||k||"keypress"===e.type&&13!=e.which||(I(),m.addClass("filter-initialized"),m.removeClass("filter-active"),E())},700)),n.on("submit","form",function(){return I(),m.addClass("filter-initialized"),m.removeClass("filter-active"),E(),!1}),e(document).on("change","form.form-order-by",function(){m.addClass("filter-initialized"),m.removeClass("filter-active"),E()}),e(document).on("submit",".search-container form",function(){return I(),m.addClass("filter-initialized"),m.removeClass("filter-active"),E(),!1}),e(document).on("click",r+" .pagination-filter a",function(t){t.preventDefault();var a=e(this).attr("href");E(z(a))}),e(document).on("click",r+" .load-more-filter",function(t){t.preventDefault();var a=m.find(".e-load-more-anchor").data("next-page");if(a)E(z(a));else{e(document).find(r+" .pagination-filter a.next").click(),C+=1;var i=m.find(".load-more");i.text("Loading..."),i.prop("disabled",!0)}}),n.on("click","li.more",function(){var t=e(this).closest("ul.taxonomy-filter");t.hasClass("yes")?t.removeClass("yes"):t.addClass("yes"),e(this).text(function(e,t){return"More..."===t?"Less...":"More..."})}),e(".cwm-filter-item").click(function(){var t=e(this).closest("li").next(".low-terms-group");e(this).is(":checked")?t.show():t.hide()}),e("form.form-tax input").on("keypress",function(e){13===e.which&&e.preventDefault()}),n.on("click",".reset-form",function(){E()}),A()}});elementorFrontend.elementsHandler.attachHandler("filter-widget",t)})}(jQuery);