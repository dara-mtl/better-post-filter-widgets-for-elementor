!function(e){"use strict";e(window).on("elementor/frontend/init",function(){let t="";t=e(".elementor-widget-filter-widget").length?"filter-widget":"search-bar-widget";let a=elementorModules.frontend.handlers.Base.extend({bindEvents(){this.getAjaxFilter()},getAjaxFilter(){let t=!1;if(e(".cwm-select2")[0]){var a=e(".cwm-select2");e(".cwm-select2 select").prop("multiple",!1).select2({dropdownParent:a}),e(".cwm-select2").css({visibility:"visible",opacity:"1",transition:"opacity 0.3s ease-in-out"})}if(e(".cwm-multi-select2")[0]){var a=e(".cwm-multi-select2");function i(){var t=e(".cwm-multi-select2 .select2-selection__rendered");t.find(".select2-selection__e-plus-button").remove(),0===e(".cwm-multi-select2 select").val().length&&t.prepend('<span class="select2-selection__choice select2-selection__e-plus-button">+</span>')}e(".cwm-multi-select2 select").prop("multiple",!0).select2({dropdownParent:a}),e(".cwm-multi-select2 select").val(null).trigger("change"),e(".cwm-multi-select2").css({visibility:"visible",opacity:"1",transition:"opacity 0.3s ease-in-out"}),i(),e(".cwm-multi-select2 select").on("change",i)}let n=this.$element.find(".filter-container"),o=window.elementorFrontendConfig.post.id,l=this.$element.data("settings");if(!l)return;let r=l.target_selector;if(!r||!r.length)return;let s=l.group_logic,c=l.dynamic_filtering,d=l.scroll_to_top,m=l.filter_post_type,f=e(r),p=f.data("id"),h=f.html(),u=f.find(".loader"),g=f.find(".pagination");g.data("max-page");let v="";var y=y||{};let w=f.data("settings");if(w&&(w.pagination||w.pagination_type)){v=w.pagination||w.pagination_type;var x,$=(w.scroll_threshold&&w.scroll_threshold.size?w.scroll_threshold.size:0)+(w.scroll_threshold&&w.scroll_threshold.unit?w.scroll_threshold.unit:"px")}else var $="0px";let C=1;if(0===o||void 0===o){let b=e('div[data-elementor-type^="archive"]').first();b.length&&(o=b.data("elementor-id")),(0===o||void 0===o)&&(o=e("div[data-elementor-id]:not(header *)").first().data("elementor-id")),(0===o||void 0===o)&&(o=e("main div:first").data("elementor-id")),(0===o||void 0===o)&&(o=e('div[data-elementor-id]:not([data-elementor-type="header"])').first().data("elementor-id"))}function _(e,t){let a;return function(){let i=this,n=arguments;clearTimeout(a),a=setTimeout(()=>{e.apply(i,n)},t)}}let k=n.find(".submit-form").length>0,z=!1,j;n.on("mousedown keydown touchstart","form.form-tax",function(){z=!0,clearTimeout(j)}),n.on("mouseup keyup touchend","form.form-tax",function(){j=setTimeout(()=>{z=!1},700)}),n.on("change keydown input","form.form-tax, .cwm-numeric-wrapper input",_(function(e){if(!k){if("change"===e.type||"keydown"===e.type&&"Enter"===e.key){E(),f.addClass("filter-initialized"),f.removeClass("filter-active"),P();return}z||(E(),f.addClass("filter-initialized"),f.removeClass("filter-active"),P())}},700)),n.on("click",".submit-form",function(){return E(),f.addClass("filter-initialized"),f.removeClass("filter-active"),P(),!1}),e(document).on("change","form.form-order-by",function(){f.addClass("filter-initialized"),f.removeClass("filter-active"),P()}),e(document).off("submit","form.search-post").on("submit","form.search-post",function(){let t=e(this).attr("action"),a=window.location.href;if(E(),f.addClass("filter-initialized"),f.removeClass("filter-active"),P(),t===a)return!1});let I=window.location.href;function A(e){var t;return(t=e.includes("?page=")?e.match(/\?page=(\d+)/):e.includes("?paged=")?e.match(/\?paged=(\d+)/):e.match(/\/(\d+)(\/|$)/)?e.match(/\/(\d+)(\/|$)/):e.match(/[?&](\w+)=\d+/))||(t=e.match(/(\d+)(\/|$)/)),t?t[1]:null}function E(){let e=window.location.origin+window.location.pathname;history.replaceState(null,"",e)}function F(){let t=f.find(".post-container").data("total-post");void 0===t&&(t=0),t=Number(t),e(".filter-post-count .number").text(t)}function P(a){var i=f.find(".post-container"),n="",l="",g="",w=e("form.search-post").find("input").val(),x=new URLSearchParams(window.location.search);x.has("search")&&(w=x.get("search")),e(".form-order-by select option:selected").each(function(){var t=e(this);n=t.data("order"),g=t.data("meta"),l=t.val()}),f.removeClass("e-load-more-pagination-end"),i.addClass("load"),f.addClass("load"),(i.hasClass("shortcode")||i.hasClass("template"))&&u.fadeIn();var C=[],b=[],k=[],z=[];function j(e){return e.reduce(function(e,t){var a=e.reduce(function(e,a,i){return a.taxonomy===t.taxonomy?i:e},-1);if(a>=0)e[a].terms=e[a].terms.concat(t.terms);else{var i={taxonomy:t.taxonomy,terms:[t.terms],logic:t.logic};e=e.concat([i])}return e},[])}e(".cwm-taxonomy-wrapper input:checked, .cwm-custom-field-wrapper input:checked").each(function(){var t=e(this);(t.closest(".cwm-taxonomy-wrapper").length?C:b).push({taxonomy:t.data("taxonomy"),terms:t.val(),logic:t.closest("div").data("logic")})}),e(".cwm-custom-field-wrapper input.input-text").each(function(){var t=e(this);t.val()&&k.push({taxonomy:t.data("taxonomy"),terms:t.val(),logic:t.closest("div").data("logic")})}),e(".cwm-taxonomy-wrapper select option:selected, .cwm-custom-field-wrapper select option:selected").each(function(){var t=e(this);t.val()&&(t.closest(".cwm-taxonomy-wrapper").length?C:b).push({taxonomy:t.data("taxonomy"),terms:t.val(),logic:t.closest("div").data("logic")})}),e(".cwm-numeric-wrapper input").each(function(){var t=e(this),a=t.data("base-value");if(""===t.val()||t.val()!=a){""===t.val()&&t.val(a);var i=t.attr("class").split(" ")[0];e(".cwm-numeric-wrapper").find("input").each(function(){var t=e(this);t.hasClass(i)&&z.push({taxonomy:t.data("taxonomy"),terms:t.val(),logic:t.closest("div").data("logic")})})}});var I=j(C),A=j(b),E=j(k),D=j(z);e.ajax({type:"POST",url:ajax_var.url,async:!0,data:{action:"post_filter_results",widget_id:p,page_id:o,group_logic:s,search_query:w,taxonomy_output:I,dynamic_filtering:c,custom_field_output:A,custom_field_like_output:E,numeric_output:D,post_type:m,order:n,order_by:l,order_by_meta:g,paged:a,archive_type:e('[name="archive_type"]').val(),archive_post_type:e('[name="archive_post_type"]').val(),archive_taxonomy:e('[name="archive_taxonomy"]').val(),archive_id:e('[name="archive_id"]').val(),nonce:ajax_var.nonce},success:function(t){var a=JSON.parse(t).html,i=window.location.href;if("0"===t){f.off(),f.html(h).fadeIn().removeClass("load"),f.removeClass("filter-active");var n=f.data("settings");"cwm_infinite"===n.pagination_type&&(n.pagination_type="load_more_infinite_scroll",f.data("settings",n)),"cwm_ajax"===n.pagination_load_type&&(n.pagination_load_type="ajax",f.data("settings",n)),F()}else{if("infinite"==v||"load_more"==v||"load_more_on_click"==v||"load_more_infinite_scroll"==v||"cwm_infinite"==v){if(f.hasClass("filter-active")){var o=f.find(".elementor-grid").children();f.hide().empty().append(e(a)),f.find(".elementor-grid").prepend(o),f.removeClass("e-load-more-pagination-loading"),f.hasClass("elementor-widget-posts")?f.fadeIn():f.show(),f.removeClass("load")}else f.html(a).fadeIn().removeClass("load")}else f.html(a).fadeIn().removeClass("load");if(u.fadeOut(),e(a).text().trim()){var l=f.find('nav[aria-label="Pagination"]');l.addClass("pagination-filter"),l.find("a.page-numbers").each(function(){var t=e(this).attr("href");"/"===i.charAt(i.length-1)&&(i=i.slice(0,-1));var a=t.replace(/.*wp-admin\/admin-ajax\.php/,i);e(this).attr("href",a)});var s=f.find(".e-load-more-anchor"),c=s.data("next-page"),d=f.find(".load-more"),m=f.find(".elementor-button-link.elementor-button");if(d.addClass("load-more-filter"),m.addClass("load-more-filter"),f.addClass("filter-active"),void 0!==c){"/"===i.charAt(i.length-1)&&(i=i.slice(0,-1));var p=c.replace(/.*wp-admin\/admin-ajax\.php/,i);s.attr("data-next-page",p)}var n=f.data("settings");"load_more_infinite_scroll"===n.pagination_type&&(n.pagination_type="cwm_infinite",f.data("settings",n)),"ajax"===n.pagination_load_type&&(n.pagination_load_type="cwm_ajax",f.data("settings",n)),F()}else{var g=e('.no-post-message[data-target-post-widget="'+r+'"]').text();g.length&&f.html('<div class="no-post">'+g+"</div>")}}},complete:function(){var a,i=f.find(".load-more-filter"),n=f.data("settings").pagination||f.data("settings").pagination_type,o=f.find(".e-load-more-anchor");if(o.length){var l=o.data("page");a=o.data("max-page")-1}else var l=f.find(".pagination").data("page"),a=f.find(".pagination").data("max-page")-1;"yes"==d&&window.scrollTo({top:f.offset().top-150,behavior:"smooth"}),l>a&&(f.addClass("e-load-more-pagination-end"),i.hide()),t=!1,f.hasClass("filter-active")&&"infinite"==n&&_(function(a){(function a(i,n){var o=n.find(".e-load-more-anchor"),l=e(document).find(r+" .pagination-filter a.next");if(!l.length){y[i]&&(y[i].disconnect(),y[i]=null);return}l.length&&o.length&&(y[i]||(y[i]=new IntersectionObserver(function(a){a.forEach(function(a){if(a.isIntersecting){var i=e(document).find(r+" .pagination-filter a.next");!t&&i.length&&n.hasClass("filter-active")&&(t=!0,i.click())}})},{root:null,rootMargin:$,threshold:0})),y[i].observe(o.get(0)))})(p,f)},800)(),f.hasClass("filter-active")&&"cwm_infinite"==n&&_(function(e){(function e(a,i){var n=i.find(".e-load-more-anchor"),o=n.data("page"),l=n.data("max-page");if(o===l){y[a]&&(y[a].disconnect(),y[a]=null);return}n.length&&o<l&&(y[a]||(y[a]=new IntersectionObserver(function(e){e.forEach(function(e){e.isIntersecting&&!t&&i.hasClass("filter-active")&&(t=!0,P(++o))})},{root:null,rootMargin:$,threshold:0})),y[a].observe(n.get(0)))})(p,f)},800)(),f.find("input").val(w),elementorFrontend.elementsHandler.runReadyTrigger(e(r)),elementorFrontend.config.experimentalFeatures.e_lazyload&&document.dispatchEvent(new Event("elementor/lazyload/observe")),f.removeClass("filter-initialized")},error:function(e,t,a){console.log("AJAX error: ",a)}})}I.includes("?search=")&&P(),e(document).on("click",r+" .pagination-filter a",function(t){t.preventDefault();var a=e(this).attr("href");P(A(a))}),e(document).on("click",r+" .load-more-filter",function(t){t.preventDefault();var a=f.find(".e-load-more-anchor").data("next-page");if(a)P(A(a));else{e(document).find(r+" .pagination-filter a.next").click(),C+=1;var i=f.find(".load-more");i.text("Loading..."),i.prop("disabled",!0)}}),n.on("click","li.more",function(){var t=e(this).closest("ul.taxonomy-filter");t.hasClass("show-toggle")?t.removeClass("show-toggle"):t.addClass("show-toggle")}),e(".cwm-filter-item").click(function(){var t=e(this).closest("li").next(".low-terms-group");e(this).is(":checked")?t.show():t.hide()}),e("form.form-tax input").on("keydown",function(e){13===e.which&&e.preventDefault()}),n.on("click",".reset-form",function(){P()}),F()}});elementorFrontend.elementsHandler.attachHandler(t,a)})}(jQuery);