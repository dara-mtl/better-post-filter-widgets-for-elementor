!function(e){"use strict";e(window).on("elementor/frontend/init",(function(){var t={},i={};const a={},n={};let r="";function o(){e(".elementor-widget-filter-widget, .elementor-widget-search-bar-widget, .elementor-widget-sorting-widget").each((function(){var r=e(this),o=r.data("id"),l=r.data("settings"),s=l?.target_selector;if(s&&e(s).length){var d=e(s),c=d.data("filters-list")?d.data("filters-list").split(","):[];c.includes(o)||(c.push(o),d.data("filters-list",c.join(",")),d.attr("data-filters-list",c.join(",")));var p=d.data("id");if(t[p]||(t[p]=d.html()),!i[p]){const e=d.data("settings");let t=e?.posts_per_page?parseInt(e.posts_per_page):null;if(!t){let e=d.find(".elementor-posts, .grid, .columns, .elementor-grid").first();e.length&&(t=e.children("article, .post, .item, .entry").length)}if(!t){let e=d.find(".swiper-wrapper").first();e.length&&(t=e.children(".swiper-slide").length)}if(!t){let e=d.find("ul.products").first();e.length&&(t=e.children("li").length)}if(!t){let e=d.find("ul").first();e.length&&(t=e.children("li").length)}if(!t){let e=d.find("div").first();e.length&&(t=e.children("div").length)}i[p]=t>0?t:50}if(r.hasClass("elementor-widget-filter-widget")){n[p]||(n[p]=[]);const e={widgetId:o,groupLogic:l?.group_logic??"",dynamicFiltering:l?.dynamic_filtering??"",scrollToTop:l?.scroll_to_top??"",displaySelectedBefore:l?.display_selected_before??"",nothingFoundMessage:l?.nothing_found_message??"It seems we can’t find what you’re looking for.",enableQueryDebug:l?.enable_query_debug??""};n[p]=e,d.data("filter-settings",e),d.attr("data-filter-settings",JSON.stringify(e)),a[p]||(a[p]=[]);const t={widgetId:o,optimize_query:"yes"===l?.optimize_query,no_found_rows:"yes"===l?.no_found_rows,suppress_filters:"yes"===l?.suppress_filters,posts_per_page:parseInt(l?.posts_per_page)||-1};a[p].push(t);const i=a[p].reduce(((e,t)=>({optimize_query:e.optimize_query||t.optimize_query,no_found_rows:e.no_found_rows||t.no_found_rows,suppress_filters:e.suppress_filters||t.suppress_filters,posts_per_page:Math.min(-1===e.posts_per_page?1/0:e.posts_per_page,-1===t.posts_per_page?1/0:t.posts_per_page)})),{optimize_query:!1,no_found_rows:!1,suppress_filters:!1,posts_per_page:-1});i.posts_per_page=i.posts_per_page===1/0?-1:i.posts_per_page,d.data("performance-settings",i),d.attr("data-performance-settings",JSON.stringify(i))}}}))}r=e(".elementor-widget-filter-widget").length?"filter-widget":e(".elementor-widget-search-bar-widget").length?"search-bar-widget":"sorting-widget",o(),e(document).on("click",".filter-title.collapsible",(function(){var t=e(this),i=t.next(".bpfwe-taxonomy-wrapper, .bpfwe-custom-field-wrapper, .bpfwe-numeric-wrapper");i.is(":visible")||i.css("display","flex").hide(),t.toggleClass("collapsed"),i.stop(!0,!0).slideToggle(300,(function(){i.is(":visible")&&i.css("display","flex")}))}));const l=elementorModules.frontend.handlers.Base.extend({bindEvents(){this.getAjaxFilter()},getAjaxFilter(){let a=!1;const r=this.$element.find(".filter-container");r.find(".bpfwe-select2 select").each((function(t){const i=e(this),a=i.closest(".bpfwe-select2"),n="bpfwe-select2-"+t;i.attr("id",n).prop("multiple",!1).select2({dropdownParent:a}),a.css({visibility:"visible",opacity:"1",transition:"opacity 0.3s ease-in-out"})})),r.find(".bpfwe-select-all").on("click",(function(){const t=e(this),i=t.data("taxonomy"),a=!t.hasClass("checked");t.toggleClass("checked",a);r.find("input.bpfwe-filter-item").filter('[data-taxonomy="'+i+'"]').prop("checked",a).trigger("change")})),r.find("input.bpfwe-filter-item").on("change",(function(){const t=e(this).data("taxonomy"),i=r.find("input.bpfwe-filter-item").filter('[data-taxonomy="'+t+'"]'),a=r.find('.bpfwe-select-all[data-taxonomy="'+t+'"]'),n=i.length===i.filter(":checked").length;a.toggleClass("checked",n)})),r.find(".bpfwe-multi-select2 select").each((function(t){const i=e(this),a=i.closest(".bpfwe-multi-select2"),n="bpfwe-multi-select2-"+t;function r(){var e=a.find(".select2-selection__rendered");e.find(".select2-selection__e-plus-button").remove(),0===i.val().length&&e.prepend('<span class="select2-selection__choice select2-selection__e-plus-button">+</span>')}i.attr("id",n).prop("multiple",!0).select2({dropdownParent:a}),i.val(null).trigger("change"),a.css({visibility:"visible",opacity:"1",transition:"opacity 0.3s ease-in-out"}),r(),i.on("change",r)})),r.on("click","li.more",(function(){e(this).closest("ul.taxonomy-filter").toggleClass("show-toggle")})),r.on("click",".low-group-trigger",(function(){var t=e(this),i=t.closest("li"),a=i.hasClass("child-term")?i.children(".low-terms-group"):i.next(".low-terms-group");a.toggle();var n=a.is(":visible");t.text(n?"-":"+"),t.attr("aria-expanded",n)})),e(document).off("mousedown",'input[type="radio"]').on("mousedown",'input[type="radio"]',(function(t){let i=e(this);i.is(":checked")?i.data("wasChecked",!0):i.data("wasChecked",!1)})),e(document).off("click",'input[type="radio"]').on("click",'input[type="radio"]',(function(t){let i=e(this);i.data("wasChecked")&&i.prop("checked",!1).trigger("change"),i.removeData("wasChecked")})),e(document).off("keydown","form.form-tax input").on("keydown","form.form-tax input",(function(e){13===e.which&&e.preventDefault()}));const l=window.location.href,s=this.$element.data("settings");if(!s)return;let d=s?.target_selector??"";if(!d||!e(d).length){let t=e(".elementor-widget-loop-carousel, .elementor-widget-loop-grid, .elementor-widget-post-widget, .elementor-widget-posts").first();if(t.length){let e=t.attr("class")?.split(" ").find((e=>e.startsWith("elementor-widget-")))||"";d=t.attr("id")?`#${t.attr("id")}`:e?`.${e}`:""}}if(!d||"."===d)return;let c=1,p="",f=e(d),g=f.data("id");f.find(".loader");f.find(".pagination").data("max-page");var u={};const m=f.data("settings");if(m&&(m.pagination||m.pagination_type)){p=m.pagination||m.pagination_type;var h=(m.scroll_threshold?.size||0)+(m.scroll_threshold?.unit||"px")}else h="0px";let _=window.elementorFrontendConfig.post.id;if(!_){if(!g)return;var w=e('[data-id="'+g+'"]').parents("[data-elementor-id]").last();w.length&&(_=w.data("elementor-id"))}function v(e,t){let i;return function(){const a=this,n=arguments;clearTimeout(i),i=setTimeout((()=>e.apply(a,n)),t)}}let y,b=!1;function x(e){var t;return(t=e.includes("?page=")?e.match(/\?page=(\d+)/):e.includes("?paged=")?e.match(/\?paged=(\d+)/):e.match(/\/(\d+)(\/|$)/)?e.match(/\/(\d+)(\/|$)/):e.match(/[?&](\w+)=\d+/))||(t=e.match(/(\d+)(\/|$)/)),t?t[1]:null}function k(){let e=window.location.origin+window.location.pathname;e=e.replace(/\/page\/\d+\/?$/,""),history.replaceState(null,"",e)}function C(t){let i=t.find(".post-container").data("total-post")||0;i=Number(i),e(".filter-post-count .number").text(i)}function j(s,d,c){0===e(document).find('div[data-filters-list*="'+s+'"]').length&&o();let p=s?e('div[data-filters-list*="'+s+'"]').data("id"):g;if(!p)return;c&&(p=c);let f=e('div[data-id="'+p+'"]');if(!f.length)return;t[p];let m=i[p],w=f.data("filters-list")?f.data("filters-list").split(","):[],y=f.find(".post-container"),b="",k="",q="",z="",F="",T="",$=f.data("settings")?.pagination||f.data("settings")?.pagination_type||"";"cwm_infinite"!==$&&"infinite"!==$||!u[p]||(u[p].disconnect(),u[p]=null);let E=e('.elementor-widget-sorting-widget[data-id="'+s+'"]').length>0,S=e('.elementor-widget-search-bar-widget[data-id="'+s+'"]').length>0,O=e('.elementor-widget-filter-widget[data-id="'+s+'"]').length>0;(E||S||O)&&(f.removeClass("filter-active"),f.data("current-page",1));const H=n[p];let M=H?.nothingFoundMessage,P=H?.scrollToTop,D=H?.displaySelectedBefore,J=!1;e(".elementor-sticky__spacer").empty(),w.forEach((function(t){if(!F){var i=e('.elementor-widget-sorting-widget[data-id="'+t+'"]');i.length&&(F=i.data("settings")?.filter_post_type||"")}if(!F){var a=e('.elementor-widget-search-bar-widget[data-id="'+t+'"]');a.length&&(F=a.data("settings")?.filter_post_type||"")}var n=e('.elementor-widget-filter-widget[data-id="'+t+'"]');n.length&&(F=n.data("settings")?.filter_post_type||"")}));var N=[],A=[],L=[],W=[];w.forEach((function(t){var i=e('.elementor-widget-search-bar-widget[data-id="'+t+'"]');i.length&&(z=i.find("form.search-post input").val()||"",z&&(J=!0));var a=e('.elementor-widget-sorting-widget[data-id="'+t+'"]');if(a.length){var n=a.find(".form-order-by select"),r=n.find("option:first-child");n.find("option:selected").each((function(){var t=e(this);b=t.data("order"),q=t.data("meta"),k=t.val(),t.val()!==r.val()&&(J=!0)}))}var o=e('.elementor-widget-filter-widget[data-id="'+t+'"]');o.length&&(o.find(".bpfwe-taxonomy-wrapper input:checked, .bpfwe-custom-field-wrapper input:checked").each((function(){var t=e(this);(t.closest(".bpfwe-taxonomy-wrapper").length?N:A).push({taxonomy:t.data("taxonomy"),terms:t.val(),logic:t.closest("div").data("logic")}),J=!0})),o.find(".bpfwe-custom-field-wrapper input.input-text").each((function(){var t=e(this);t.val()&&(L.push({taxonomy:t.data("taxonomy"),terms:t.val(),logic:t.closest("div").data("logic")}),J=!0)})),o.find(".bpfwe-taxonomy-wrapper select option:selected, .bpfwe-custom-field-wrapper select option:selected").each((function(){var t=e(this);t.val()&&((t.closest(".bpfwe-taxonomy-wrapper").length?N:A).push({taxonomy:t.data("taxonomy"),terms:t.val(),logic:t.closest("div").data("logic")}),J=!0)})),o.find(".bpfwe-numeric-wrapper input").each((function(){var t=e(this),i=t.data("base-value");if(""===t.val()||t.val()!=i){""===t.val()&&t.val(i);var a=t.attr("class").split(" ")[0];o.find(".bpfwe-numeric-wrapper input").each((function(){var t=e(this);t.hasClass(a)&&(W.push({taxonomy:t.data("taxonomy"),terms:t.val(),logic:t.closest("div").data("logic")}),J=!0)}))}})),T=o.find('.bpfwe-filter-item[data-taxonomy="post_date"]').map((function(){return this.value})).get().join(","))}));var B=new URLSearchParams(window.location.search);if(B.has("search")&&(z=B.get("search"),z&&(J=!0)),f.removeClass("e-load-more-pagination-end"),y.addClass("load"),f.addClass("load"),f.addClass("filter-initialized"),(y.hasClass("shortcode")||y.hasClass("template"))&&f.find(".loader").fadeIn(),e(".bpfwe-selected-terms, .bpfwe-selected-count").length){let t=[],i=e('.elementor-widget-filter-widget[data-id="'+s+'"]');i.find('input[type="checkbox"]:checked, input[type="radio"]:checked').each((function(){let i=e(this).closest("label").find("span").first().text().trim();i&&t.push(i)})),i.find("select option:selected").each((function(){let i=e(this).text().trim();i&&e(this).val()&&t.push(i)}));let a=t.length>0?D+t.join(", "):"";e(".bpfwe-selected-terms").each((function(){let t=e(this),i=t.find(".elementor-widget-container").first(),n=i.length?i.children().first():t.children().first();n.length&&n.text(a)}));let n=t.length>0?t.length+" "+D:"";e(".bpfwe-selected-count").each((function(){let t=e(this),i=t.find(".elementor-widget-container").first(),a=i.length?i.children().first():t.children().first();a.length&&a.text(n)}))}function Q(e){return e.reduce((function(e,t){var i=e.reduce((function(e,i,a){return i.taxonomy===t.taxonomy?a:e}),-1);return i>=0?e[i].terms=e[i].terms.concat(t.terms):e=e.concat([{taxonomy:t.taxonomy,terms:[t.terms],logic:t.logic}]),e}),[])}function R(t){const i=e(t);i.length&&(elementorFrontend.elementsHandler.runReadyTrigger(i),i.find("[data-element_type]").each((function(){elementorFrontend.elementsHandler.runReadyTrigger(e(this))})),"function"==typeof elementorFrontend?.utils?.runElementHandlers&&elementorFrontend.utils.runElementHandlers(i[0]),e(document).trigger("elementor/lazyload/observe"))}var U=Q(N),X=Q(A),G=Q(L),K=Q(W);e.ajax({type:"POST",url:ajax_var.url,async:!0,data:{action:"post_filter_results",widget_id:p,page_id:_,group_logic:H?.groupLogic||"",search_query:z,date_query:T,taxonomy_output:U,dynamic_filtering:H?.dynamicFiltering,custom_field_output:X,custom_field_like_output:G,numeric_output:K,post_type:F,posts_per_page:m,order:b,order_by:k,order_by_meta:q,paged:d,archive_type:e('[name="archive_type"]').val(),archive_post_type:e('[name="archive_post_type"]').val(),archive_taxonomy:e('[name="archive_taxonomy"]').val(),archive_id:e('[name="archive_id"]').val(),nonce:ajax_var.nonce,performance_settings:JSON.stringify(I(p)),enable_query_debug:H?.enableQueryDebug||""},success:function(i){var a=JSON.parse(i),n=a.html,o=l.replace(/\/page\/\d+\/?($|\?)/,"/$1").replace(/[?&]e-page-[a-z0-9]+=\d+/i,"").replace(/[?&]product-page=\d+/i,"").replace(/[?&]paged=\d+/i,"").replace(/\?&+/,"?").replace(/\?$/,"");r.find("form").serialize();if(a.query){var s='<div class="query-debug-frame" style="background:#f5f5f5; border:1px solid #ccc; padding:10px; margin:15px 0; font-family: monospace; white-space: pre-wrap;">'+JSON.stringify(a.query,null,2)+"</div>",d=e(document).find(".query-debug-frame");d.length&&d.replaceWith(s)}let c=t[p];if("0"!==i&&J){if(["infinite","load_more","load_more_on_click","load_more_infinite_scroll","cwm_infinite"].includes($))if(f.hasClass("filter-active")){var g=f.find(".elementor-grid").children();f.hide().empty().append(e(n)),f.find(".elementor-grid").prepend(g),f.removeClass("e-load-more-pagination-loading"),f[f.hasClass("elementor-widget-posts")?"fadeIn":"show"](),f.removeClass("load")}else f.html(n).fadeIn().removeClass("load");else f.html(n).fadeIn().removeClass("load");if(f.find(".loader").fadeOut(),e(n).text().trim()){var u=f.find('nav[aria-label="Pagination"], nav[aria-label="Product Pagination"]');u.addClass("pagination-filter"),u.find("a.page-numbers").each((function(){var t=e(this).attr("href");o.endsWith("/")&&(o=o.slice(0,-1)),e(this).attr("href",t.replace(/.*wp-admin\/admin-ajax\.php/,o))}));var m=f.find(".e-load-more-anchor"),h=m.data("next-page"),_=f.find(".load-more"),w=f.find(".e-load-more-anchor").nextAll().find(".elementor-button-link.elementor-button");if(_.addClass("load-more-filter"),w.addClass("load-more-filter"),f.addClass("filter-active"),h){o.endsWith("/")&&(o=o.slice(0,-1)),m.attr("data-next-page",h.replace(/.*wp-admin\/admin-ajax\.php/,o))}v=f.data("settings");"load_more_infinite_scroll"===v?.pagination_type&&(v.pagination_type="cwm_infinite",f.data("settings",v)),"ajax"===v?.pagination_load_type&&(v.pagination_load_type="cwm_ajax",f.data("settings",v)),C(f)}else M=M.replace(/</g,"<").replace(/>/g,">"),M.trim()&&f.html('<div class="no-post">'+M+"</div>")}else{f.html(c).fadeIn().removeClass("load filter-active");var v=f.data("settings");"cwm_infinite"===v?.pagination_type&&(v.pagination_type="load_more_infinite_scroll",f.data("settings",v)),"cwm_ajax"===v?.pagination_load_type&&(v.pagination_load_type="ajax",f.data("settings",v)),C(f)}f.removeClass("filter-initialized")},complete:function(){var e=f.find(".load-more-filter");$=f.data("settings")?.pagination||f.data("settings")?.pagination_type||"";var t=f.find(".e-load-more-anchor");if(t.length){var i=t.data("page");n=t.data("max-page")-1}else{i=f.find(".pagination").data("page");var n=f.find(".pagination").data("max-page")-1}"yes"===P&&window.scrollTo({top:f.offset().top-150,behavior:"smooth"}),i>n&&(f.addClass("e-load-more-pagination-end"),e.hide()),a=!1,f.hasClass("filter-active")&&"infinite"===$&&v((function(){!function(e,t){var i=t.find(".e-load-more-anchor"),n=t.find(".pagination-filter a.next");if(!n.length)return void(u[e]&&(u[e].disconnect(),u[e]=null));n.length&&i.length&&(u[e]||(u[e]=new IntersectionObserver((function(i){i.forEach((function(i){if(i.isIntersecting){var n=t.find(".pagination-filter a.next");if(!a&&n.length&&t.hasClass("filter-active"))a=!0,j(null,x(n.attr("href")),e)}}))}),{root:null,rootMargin:h,threshold:0})),u[e].observe(i.get(0)))}(p,f)}),800)(),f.hasClass("filter-active")&&"cwm_infinite"===$&&v((function(){!function(e,t){var i=t.find(".e-load-more-anchor"),n=t.data("current-page")||1,r=i.data("max-page");if(n>=r)return void(u[e]&&(u[e].disconnect(),u[e]=null));i.length&&n<r&&(u[e]||(u[e]=new IntersectionObserver((function(i){i.forEach((function(i){i.isIntersecting&&!a&&t.hasClass("filter-active")&&(a=!0,n++,t.data("current-page",n),j(null,n,e))}))}),{root:null,rootMargin:h,threshold:0})),u[e].observe(i.get(0)))}(p,f)}),800)(),f.find("input").val(z),R(f)},error:function(e,i,a){console.log("AJAX error:",a);let n=t[p];f.html(n).fadeIn().removeClass("load filter-active");var r=f.data("settings");"cwm_infinite"===r?.pagination_type&&(r.pagination_type="load_more_infinite_scroll",f.data("settings",r)),"cwm_ajax"===r?.pagination_load_type&&(r.pagination_load_type="ajax",f.data("settings",r)),C(f),R(f)}})}function I(t){let i=e(`.elementor-element[data-id="${t}"]`).data("performance-settings");return i||(i={optimize_query:!1,no_found_rows:!1,suppress_filters:!1,cache_results:!0,posts_per_page:-1}),i.posts_per_page=parseInt(i.posts_per_page)||-1,i}r.on("mousedown keydown touchstart","form.form-tax",(function(){b=!0,clearTimeout(y)})),r.on("mouseup keyup touchend","form.form-tax",(function(){y=setTimeout((()=>b=!1),700)})),e(document).off("change keydown input","form.form-tax, .bpfwe-numeric-wrapper input").on("change keydown input","form.form-tax, .bpfwe-numeric-wrapper input",v((function(t){var i=e(this).closest(".elementor-widget-filter-widget"),a=i.data("id");if(!a)return;if(!(i.find(".submit-form").length>0)){if("change"===t.type||"keydown"===t.type&&"Enter"===t.key)return k(),void j(a);b||(k(),j(a))}}),700)),e(document).off("click",".submit-form").on("click",".submit-form",(function(){var t=e(this).closest(".elementor-widget-filter-widget").data("id");if(t)return k(),j(t),!1})),e(document).off("change","form.form-order-by").on("change","form.form-order-by",(function(){var t=e(this).closest(".elementor-widget-sorting-widget").data("id");t&&(k(),j(t))})),e(document).off("submit","form.search-post").on("submit","form.search-post",(function(){var t=e(this).closest(".elementor-widget-search-bar-widget").data("id");if(t)return k(),j(t),!e(this).hasClass("no-redirect")&&void 0})),l.includes("?search=")&&j(),e(document).off("click",".pagination-filter a").on("click",".pagination-filter a",(function(t){var i=e(this).closest("[data-id]").data("id");t.preventDefault(),j(null,x(e(this).attr("href")),i)})),e(document).off("click",".load-more-filter").on("click",".load-more-filter",(function(t){t.preventDefault();var i=e(this).closest("[data-id]"),a=i.data("id"),n=i.find(".e-load-more-anchor").data("next-page");if(n){j(null,x(n),a)}else{var r=i.find(".pagination-filter a.next");if(r.length)r.trigger("click"),c++,i.data("current-page",c),i.find(".load-more").text("Loading...").prop("disabled",!0)}})),r.on("click",".reset-form",(function(){var t=e(this).closest(".elementor-widget-filter-widget").data("id"),i=e('div[data-filters-list*="'+t+'"]');i.data("id")&&i.length&&((i.data("filters-list")?i.data("filters-list").split(","):[]).forEach((function(t){var i=e('.elementor-widget-filter-widget[data-id="'+t+'"]');i.length&&(i.find("input:checked").prop("checked",!1),i.find("select").each((function(){e(this).val(e(this).find("option:first").val()).trigger("change")})),i.find(".bpfwe-numeric-wrapper input").each((function(){var t=e(this).data("base-value");e(this).val(t).trigger("input")})),i.find("input.input-text").val("").trigger("input"));var a=e('.elementor-widget-sorting-widget[data-id="'+t+'"]');a.length&&a.find("form.form-order-by select").prop("selectedIndex",0).trigger("change");var n=e('.elementor-widget-search-bar-widget[data-id="'+t+'"]');n.length&&n.find('form.search-post input[name="s"]').val("").trigger("input")})),k(),i.addClass("filter-initialized"),i.removeClass("filter-active"),i.data("current-page",1),j(t))})),C(f)}});elementorFrontend.isEditMode()?elementorFrontend.elementsHandler.attachHandler("filter-widget",l):elementorFrontend.elementsHandler.attachHandler(r,l)}))}(jQuery);