!function(e){"use strict";e(window).on("elementor/frontend/init",(function(){var t={},i={};const a={},n={};let o="";o=e(".elementor-widget-filter-widget").length?"filter-widget":e(".elementor-widget-search-bar-widget").length?"search-bar-widget":"sorting-widget",e(".elementor-widget-filter-widget, .elementor-widget-search-bar-widget, .elementor-widget-sorting-widget").each((function(){var o=e(this),r=o.data("id"),l=o.data("settings"),s=l?.target_selector;if(s&&e(s).length){var d=e(s),c=d.data("filters-list")?d.data("filters-list").split(","):[];c.includes(r)||(c.push(r),d.data("filters-list",c.join(",")),d.attr("data-filters-list",c.join(",")));var p=d.data("id");if(t[p]||(t[p]=d.html()),!i[p]){const e=d.data("settings");let t=e?.posts_per_page?parseInt(e.posts_per_page):null;if(!t){let e=d.find(".elementor-posts, .grid, .columns, .elementor-grid").first();e.length&&(t=e.children("article, .post, .item, .entry").length)}if(!t){let e=d.find(".swiper-wrapper").first();e.length&&(t=e.children(".swiper-slide").length)}if(!t){let e=d.find("ul.products").first();e.length&&(t=e.children("li").length)}if(!t){let e=d.find("ul").first();e.length&&(t=e.children("li").length)}if(!t){let e=d.find("div").first();e.length&&(t=e.children("div").length)}i[p]=t>0?t:50}if(o.hasClass("elementor-widget-filter-widget")){n[p]||(n[p]=[]);const e={widgetId:r,groupLogic:l?.group_logic??"",dynamicFiltering:l?.dynamic_filtering??"",scrollToTop:l?.scroll_to_top??"",displaySelectedBefore:l?.display_selected_before??"",nothingFoundMessage:l?.nothing_found_message??"It seems we can’t find what you’re looking for."};n[p]=e,d.data("filter-settings",e),d.attr("data-filter-settings",JSON.stringify(e)),a[p]||(a[p]=[]);const t={widgetId:r,optimize_query:"yes"===l?.optimize_query,no_found_rows:"yes"===l?.no_found_rows,suppress_filters:"yes"===l?.suppress_filters,posts_per_page:parseInt(l?.posts_per_page)||-1};a[p].push(t);const i=a[p].reduce(((e,t)=>({optimize_query:e.optimize_query||t.optimize_query,no_found_rows:e.no_found_rows||t.no_found_rows,suppress_filters:e.suppress_filters||t.suppress_filters,posts_per_page:Math.min(-1===e.posts_per_page?1/0:e.posts_per_page,-1===t.posts_per_page?1/0:t.posts_per_page)})),{optimize_query:!1,no_found_rows:!1,suppress_filters:!1,posts_per_page:-1});i.posts_per_page=i.posts_per_page===1/0?-1:i.posts_per_page,d.data("performance-settings",i),d.attr("data-performance-settings",JSON.stringify(i))}}})),e(document).on("click",".filter-title.collapsible",(function(){var t=e(this),i=t.next(".bpfwe-taxonomy-wrapper, .bpfwe-custom-field-wrapper");i.is(":visible")||i.css("display","flex").hide(),t.toggleClass("collapsed"),i.stop(!0,!0).slideToggle(300,(function(){i.is(":visible")&&i.css("display","flex")}))}));const r=elementorModules.frontend.handlers.Base.extend({bindEvents(){this.getAjaxFilter()},getAjaxFilter(){let a=!1;const o=this.$element.find(".filter-container");o.find(".bpfwe-select2 select").each((function(t){const i=e(this),a=i.closest(".bpfwe-select2"),n="bpfwe-select2-"+t;i.attr("id",n).prop("multiple",!1).select2({dropdownParent:a}),a.css({visibility:"visible",opacity:"1",transition:"opacity 0.3s ease-in-out"})})),o.find(".bpfwe-select-all").on("click",(function(){const t=e(this),i=t.data("taxonomy"),a=!t.hasClass("checked");t.toggleClass("checked",a);o.find("input.bpfwe-filter-item").filter('[data-taxonomy="'+i+'"]').prop("checked",a).trigger("change")})),o.find("input.bpfwe-filter-item").on("change",(function(){const t=e(this).data("taxonomy"),i=o.find("input.bpfwe-filter-item").filter('[data-taxonomy="'+t+'"]'),a=o.find('.bpfwe-select-all[data-taxonomy="'+t+'"]'),n=i.length===i.filter(":checked").length;a.toggleClass("checked",n)})),o.find(".bpfwe-multi-select2 select").each((function(t){const i=e(this),a=i.closest(".bpfwe-multi-select2"),n="bpfwe-multi-select2-"+t;function o(){var e=a.find(".select2-selection__rendered");e.find(".select2-selection__e-plus-button").remove(),0===i.val().length&&e.prepend('<span class="select2-selection__choice select2-selection__e-plus-button">+</span>')}i.attr("id",n).prop("multiple",!0).select2({dropdownParent:a}),i.val(null).trigger("change"),a.css({visibility:"visible",opacity:"1",transition:"opacity 0.3s ease-in-out"}),o(),i.on("change",o)})),o.on("click","li.more",(function(){e(this).closest("ul.taxonomy-filter").toggleClass("show-toggle")})),o.on("click",".low-group-trigger",(function(){var t=e(this),i=t.closest("li"),a=i.hasClass("child-term")?i.children(".low-terms-group"):i.next(".low-terms-group");a.toggle();var n=a.is(":visible");t.text(n?"-":"+"),t.attr("aria-expanded",n)})),e(document).off("mousedown",'input[type="radio"]').on("mousedown",'input[type="radio"]',(function(t){let i=e(this);i.is(":checked")?i.data("wasChecked",!0):i.data("wasChecked",!1)})),e(document).off("click",'input[type="radio"]').on("click",'input[type="radio"]',(function(t){let i=e(this);i.data("wasChecked")&&i.prop("checked",!1).trigger("change"),i.removeData("wasChecked")})),e(document).off("keydown","form.form-tax input").on("keydown","form.form-tax input",(function(e){13===e.which&&e.preventDefault()}));const r=window.location.href,l=this.$element.data("settings");if(!l)return;let s=l?.target_selector??"";if(!s||!e(s).length){let t=e(".elementor-widget-loop-carousel, .elementor-widget-loop-grid, .elementor-widget-post-widget, .elementor-widget-posts").first();if(t.length){let e=t.attr("class")?.split(" ").find((e=>e.startsWith("elementor-widget-")))||"";s=t.attr("id")?`#${t.attr("id")}`:e?`.${e}`:""}}if(!s||"."===s)return;let d=1,c="",p=e(s),f=p.data("id");p.find(".loader");p.find(".pagination").data("max-page");var g={};const m=p.data("settings");if(m&&(m.pagination||m.pagination_type)){c=m.pagination||m.pagination_type;var u=(m.scroll_threshold?.size||0)+(m.scroll_threshold?.unit||"px")}else u="0px";let h=window.elementorFrontendConfig.post.id;if(!h){if(!f)return;var _=e('[data-id="'+f+'"]').parents("[data-elementor-id]").last();_.length&&(h=_.data("elementor-id"))}function w(e,t){let i;return function(){const a=this,n=arguments;clearTimeout(i),i=setTimeout((()=>e.apply(a,n)),t)}}let v,y=!1;function b(e){var t;return(t=e.includes("?page=")?e.match(/\?page=(\d+)/):e.includes("?paged=")?e.match(/\?paged=(\d+)/):e.match(/\/(\d+)(\/|$)/)?e.match(/\/(\d+)(\/|$)/):e.match(/[?&](\w+)=\d+/))||(t=e.match(/(\d+)(\/|$)/)),t?t[1]:null}function x(){let e=window.location.origin+window.location.pathname;e=e.replace(/\/page\/\d+\/?$/,""),history.replaceState(null,"",e)}function k(t){let i=t.find(".post-container").data("total-post")||0;i=Number(i),e(".filter-post-count .number").text(i)}function C(l,s,d){let c=l?e('div[data-filters-list*="'+l+'"]').data("id"):f;if(!c)return;d&&(c=d);let p=e('div[data-id="'+c+'"]');if(!p.length)return;t[c];let m=i[c],_=p.data("filters-list")?p.data("filters-list").split(","):[],v=p.find(".post-container"),y="",x="",z="",I="",F="",T="",E=p.data("settings")?.pagination||p.data("settings")?.pagination_type||"";"cwm_infinite"!==E&&"infinite"!==E||!g[c]||(g[c].disconnect(),g[c]=null);let $=e('.elementor-widget-sorting-widget[data-id="'+l+'"]').length>0,q=e('.elementor-widget-search-bar-widget[data-id="'+l+'"]').length>0,S=e('.elementor-widget-filter-widget[data-id="'+l+'"]').length>0;($||q||S)&&(p.removeClass("filter-active"),p.data("current-page",1));const O=n[c];let M=O?.nothingFoundMessage,P=O?.scrollToTop,H=O?.displaySelectedBefore,A=!1;e(".elementor-sticky__spacer").empty(),_.forEach((function(t){if(!F){var i=e('.elementor-widget-sorting-widget[data-id="'+t+'"]');i.length&&(F=i.data("settings")?.filter_post_type||"")}if(!F){var a=e('.elementor-widget-search-bar-widget[data-id="'+t+'"]');a.length&&(F=a.data("settings")?.filter_post_type||"")}var n=e('.elementor-widget-filter-widget[data-id="'+t+'"]');n.length&&(F=n.data("settings")?.filter_post_type||"")}));var J=[],N=[],D=[],L=[];_.forEach((function(t){var i=e('.elementor-widget-search-bar-widget[data-id="'+t+'"]');i.length&&(I=i.find("form.search-post input").val()||"",I&&(A=!0));var a=e('.elementor-widget-sorting-widget[data-id="'+t+'"]');if(a.length){var n=a.find(".form-order-by select"),o=n.find("option:first-child");n.find("option:selected").each((function(){var t=e(this);y=t.data("order"),z=t.data("meta"),x=t.val(),t.val()!==o.val()&&(A=!0)}))}var r=e('.elementor-widget-filter-widget[data-id="'+t+'"]');r.length&&(r.find(".bpfwe-taxonomy-wrapper input:checked, .bpfwe-custom-field-wrapper input:checked").each((function(){var t=e(this);(t.closest(".bpfwe-taxonomy-wrapper").length?J:N).push({taxonomy:t.data("taxonomy"),terms:t.val(),logic:t.closest("div").data("logic")}),A=!0})),r.find(".bpfwe-custom-field-wrapper input.input-text").each((function(){var t=e(this);t.val()&&(D.push({taxonomy:t.data("taxonomy"),terms:t.val(),logic:t.closest("div").data("logic")}),A=!0)})),r.find(".bpfwe-taxonomy-wrapper select option:selected, .bpfwe-custom-field-wrapper select option:selected").each((function(){var t=e(this);t.val()&&((t.closest(".bpfwe-taxonomy-wrapper").length?J:N).push({taxonomy:t.data("taxonomy"),terms:t.val(),logic:t.closest("div").data("logic")}),A=!0)})),r.find(".bpfwe-numeric-wrapper input").each((function(){var t=e(this),i=t.data("base-value");if(""===t.val()||t.val()!=i){""===t.val()&&t.val(i);var a=t.attr("class").split(" ")[0];r.find(".bpfwe-numeric-wrapper input").each((function(){var t=e(this);t.hasClass(a)&&(L.push({taxonomy:t.data("taxonomy"),terms:t.val(),logic:t.closest("div").data("logic")}),A=!0)}))}})),T=r.find('.bpfwe-filter-item[data-taxonomy="post_date"]').map((function(){return this.value})).get().join(","))}));var B=new URLSearchParams(window.location.search);if(B.has("search")&&(I=B.get("search"),I&&(A=!0)),p.removeClass("e-load-more-pagination-end"),v.addClass("load"),p.addClass("load"),p.addClass("filter-initialized"),(v.hasClass("shortcode")||v.hasClass("template"))&&p.find(".loader").fadeIn(),e(".bpfwe-selected-terms, .bpfwe-selected-count").length){let t=[],i=e('.elementor-widget-filter-widget[data-id="'+l+'"]');i.find('input[type="checkbox"]:checked, input[type="radio"]:checked').each((function(){let i=e(this).closest("label").find("span").first().text().trim();i&&t.push(i)})),i.find("select option:selected").each((function(){let i=e(this).text().trim();i&&e(this).val()&&t.push(i)}));let a=t.length>0?H+t.join(", "):"";e(".bpfwe-selected-terms").each((function(){let t=e(this),i=t.find(".elementor-widget-container").first(),n=i.length?i.children().first():t.children().first();n.length&&n.text(a)}));let n=t.length>0?t.length+" "+H:"";e(".bpfwe-selected-count").each((function(){let t=e(this),i=t.find(".elementor-widget-container").first(),a=i.length?i.children().first():t.children().first();a.length&&a.text(n)}))}function R(e){return e.reduce((function(e,t){var i=e.reduce((function(e,i,a){return i.taxonomy===t.taxonomy?a:e}),-1);return i>=0?e[i].terms=e[i].terms.concat(t.terms):e=e.concat([{taxonomy:t.taxonomy,terms:[t.terms],logic:t.logic}]),e}),[])}var W=R(J),Q=R(N),U=R(D),X=R(L);e.ajax({type:"POST",url:ajax_var.url,async:!0,data:{action:"post_filter_results",widget_id:c,page_id:h,group_logic:O?.groupLogic||"",search_query:I,date_query:T,taxonomy_output:W,dynamic_filtering:O?.dynamicFiltering,custom_field_output:Q,custom_field_like_output:U,numeric_output:X,post_type:F,posts_per_page:m,order:y,order_by:x,order_by_meta:z,paged:s,archive_type:e('[name="archive_type"]').val(),archive_post_type:e('[name="archive_post_type"]').val(),archive_taxonomy:e('[name="archive_taxonomy"]').val(),archive_id:e('[name="archive_id"]').val(),nonce:ajax_var.nonce,performance_settings:JSON.stringify(j(c))},success:function(i){var a=JSON.parse(i).html,n=r.replace(/\/page\/\d+\/?($|\?)/,"/$1").replace(/[?&]e-page-[a-z0-9]+=\d+/i,"").replace(/[?&]product-page=\d+/i,"").replace(/[?&]paged=\d+/i,"").replace(/\?&+/,"?").replace(/\?$/,"");o.find("form").serialize();let l=t[c];if("0"!==i&&A){if(["infinite","load_more","load_more_on_click","load_more_infinite_scroll","cwm_infinite"].includes(E))if(p.hasClass("filter-active")){var s=p.find(".elementor-grid").children();p.hide().empty().append(e(a)),p.find(".elementor-grid").prepend(s),p.removeClass("e-load-more-pagination-loading"),p[p.hasClass("elementor-widget-posts")?"fadeIn":"show"](),p.removeClass("load")}else p.html(a).fadeIn().removeClass("load");else p.html(a).fadeIn().removeClass("load");if(p.find(".loader").fadeOut(),e(a).text().trim()){var d=p.find('nav[aria-label="Pagination"], nav[aria-label="Product Pagination"]');d.addClass("pagination-filter"),d.find("a.page-numbers").each((function(){var t=e(this).attr("href");n.endsWith("/")&&(n=n.slice(0,-1)),e(this).attr("href",t.replace(/.*wp-admin\/admin-ajax\.php/,n))}));var f=p.find(".e-load-more-anchor"),g=f.data("next-page"),m=p.find(".load-more"),u=p.find(".e-load-more-anchor").nextAll().find(".elementor-button-link.elementor-button");if(m.addClass("load-more-filter"),u.addClass("load-more-filter"),p.addClass("filter-active"),g){n.endsWith("/")&&(n=n.slice(0,-1)),f.attr("data-next-page",g.replace(/.*wp-admin\/admin-ajax\.php/,n))}h=p.data("settings");"load_more_infinite_scroll"===h?.pagination_type&&(h.pagination_type="cwm_infinite",p.data("settings",h)),"ajax"===h?.pagination_load_type&&(h.pagination_load_type="cwm_ajax",p.data("settings",h)),k(p)}else M=M.replace(/</g,"<").replace(/>/g,">"),M.trim()&&p.html('<div class="no-post">'+M+"</div>")}else{p.html(l).fadeIn().removeClass("load filter-active");var h=p.data("settings");"cwm_infinite"===h?.pagination_type&&(h.pagination_type="load_more_infinite_scroll",p.data("settings",h)),"cwm_ajax"===h?.pagination_load_type&&(h.pagination_load_type="ajax",p.data("settings",h)),k(p)}p.removeClass("filter-initialized")},complete:function(){var e=p.find(".load-more-filter");E=p.data("settings")?.pagination||p.data("settings")?.pagination_type||"";var t=p.find(".e-load-more-anchor");if(t.length){var i=t.data("page");n=t.data("max-page")-1}else{i=p.find(".pagination").data("page");var n=p.find(".pagination").data("max-page")-1}"yes"===P&&window.scrollTo({top:p.offset().top-150,behavior:"smooth"}),i>n&&(p.addClass("e-load-more-pagination-end"),e.hide()),a=!1,p.hasClass("filter-active")&&"infinite"===E&&w((function(){!function(e,t){var i=t.find(".e-load-more-anchor"),n=t.find(".pagination-filter a.next");if(!n.length)return void(g[e]&&(g[e].disconnect(),g[e]=null));n.length&&i.length&&(g[e]||(g[e]=new IntersectionObserver((function(i){i.forEach((function(i){if(i.isIntersecting){var n=t.find(".pagination-filter a.next");if(!a&&n.length&&t.hasClass("filter-active"))a=!0,C(null,b(n.attr("href")),e)}}))}),{root:null,rootMargin:u,threshold:0})),g[e].observe(i.get(0)))}(c,p)}),800)(),p.hasClass("filter-active")&&"cwm_infinite"===E&&w((function(){!function(e,t){var i=t.find(".e-load-more-anchor"),n=t.data("current-page")||1,o=i.data("max-page");if(n>=o)return void(g[e]&&(g[e].disconnect(),g[e]=null));i.length&&n<o&&(g[e]||(g[e]=new IntersectionObserver((function(i){i.forEach((function(i){i.isIntersecting&&!a&&t.hasClass("filter-active")&&(a=!0,n++,t.data("current-page",n),C(null,n,e))}))}),{root:null,rootMargin:u,threshold:0})),g[e].observe(i.get(0)))}(c,p)}),800)(),p.find("input").val(I),elementorFrontend.elementsHandler.runReadyTrigger(p),elementorFrontend.config.experimentalFeatures.e_lazyload&&document.dispatchEvent(new Event("elementor/lazyload/observe"))},error:function(e,i,a){console.log("AJAX error:",a);let n=t[c];p.html(n).fadeIn().removeClass("load filter-active");var o=p.data("settings");"cwm_infinite"===o?.pagination_type&&(o.pagination_type="load_more_infinite_scroll",p.data("settings",o)),"cwm_ajax"===o?.pagination_load_type&&(o.pagination_load_type="ajax",p.data("settings",o)),k(p),elementorFrontend.elementsHandler.runReadyTrigger(p),elementorFrontend.config.experimentalFeatures.e_lazyload&&document.dispatchEvent(new Event("elementor/lazyload/observe"))}})}function j(t){let i=e(`.elementor-element[data-id="${t}"]`).data("performance-settings");return i||(i={optimize_query:!1,no_found_rows:!1,suppress_filters:!1,cache_results:!0,posts_per_page:-1}),i.posts_per_page=parseInt(i.posts_per_page)||-1,i}o.on("mousedown keydown touchstart","form.form-tax",(function(){y=!0,clearTimeout(v)})),o.on("mouseup keyup touchend","form.form-tax",(function(){v=setTimeout((()=>y=!1),700)})),e(document).off("change keydown input","form.form-tax, .bpfwe-numeric-wrapper input").on("change keydown input","form.form-tax, .bpfwe-numeric-wrapper input",w((function(t){var i=e(this).closest(".elementor-widget-filter-widget"),a=i.data("id");if(!a)return;if(!(i.find(".submit-form").length>0)){if("change"===t.type||"keydown"===t.type&&"Enter"===t.key)return x(),void C(a);y||(x(),C(a))}}),700)),e(document).off("click",".submit-form").on("click",".submit-form",(function(){var t=e(this).closest(".elementor-widget-filter-widget").data("id");if(t)return x(),C(t),!1})),e(document).off("change","form.form-order-by").on("change","form.form-order-by",(function(){var t=e(this).closest(".elementor-widget-sorting-widget").data("id");t&&(x(),C(t))})),e(document).off("submit","form.search-post").on("submit","form.search-post",(function(){var t=e(this).closest(".elementor-widget-search-bar-widget").data("id");if(t)return x(),C(t),!e(this).hasClass("no-redirect")&&void 0})),r.includes("?search=")&&C(),e(document).off("click",".pagination-filter a").on("click",".pagination-filter a",(function(t){var i=e(this).closest("[data-id]").data("id");t.preventDefault(),C(null,b(e(this).attr("href")),i)})),e(document).off("click",".load-more-filter").on("click",".load-more-filter",(function(t){t.preventDefault();var i=e(this).closest("[data-id]"),a=i.data("id"),n=i.find(".e-load-more-anchor").data("next-page");if(n){C(null,b(n),a)}else{var o=i.find(".pagination-filter a.next");if(o.length)o.trigger("click"),d++,i.data("current-page",d),i.find(".load-more").text("Loading...").prop("disabled",!0)}})),o.on("click",".reset-form",(function(){var t=e(this).closest(".elementor-widget-filter-widget").data("id"),i=e('div[data-filters-list*="'+t+'"]');i.data("id")&&i.length&&((i.data("filters-list")?i.data("filters-list").split(","):[]).forEach((function(t){var i=e('.elementor-widget-filter-widget[data-id="'+t+'"]');i.length&&(i.find("input:checked").prop("checked",!1),i.find("select").each((function(){e(this).val(e(this).find("option:first").val()).trigger("change")})),i.find(".bpfwe-numeric-wrapper input").each((function(){var t=e(this).data("base-value");e(this).val(t).trigger("input")})),i.find("input.input-text").val("").trigger("input"));var a=e('.elementor-widget-sorting-widget[data-id="'+t+'"]');a.length&&a.find("form.form-order-by select").prop("selectedIndex",0).trigger("change");var n=e('.elementor-widget-search-bar-widget[data-id="'+t+'"]');n.length&&n.find('form.search-post input[name="s"]').val("").trigger("input")})),x(),i.addClass("filter-initialized"),i.removeClass("filter-active"),i.data("current-page",1),C(t))})),k(p)}});elementorFrontend.isEditMode()?elementorFrontend.elementsHandler.attachHandler("filter-widget",r):elementorFrontend.elementsHandler.attachHandler(o,r)}))}(jQuery);